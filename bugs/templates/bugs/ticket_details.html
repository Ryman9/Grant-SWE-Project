{% extends 'bugs/base.html' %}
{% load static %}
{% block content %}
<script>document.title="Ticket #{{ticket.ticketId}} - BugTracker";</script>
<div class="row text-white" style="width:100%;padding-top:20px">
  <div style="margin-left:auto;margin-right:auto;width:100%;text-align:center;">
      <h2><span class="badge badge-secondary">#{{ticket.ticketId}}</span> {{ticket.title}}</h2>
      <h4>Ticket Details</h4>
  </div>
</div>
<div class="row centered text-white" style="max-width: 500px">
    <form action="/ticket/update/{{ticket.ticketId}}" method="GET">
        <div class="form-group row">
            <label for="desc">Title</label>
            <input class="form-control" id="title" name="title" value="{{ticket.title}}">
        </div>
        <div class="form-group row">
            <label for="desc">Description</label>
            <textarea class="form-control" id="desc" rows="6" cols="60" name="description">{{ticket.description}}</textarea>
        </div>
        <div class="form-group row">
            <label for="status">Status</label>
            <select id="status" name="status" class="custom-select">
              <option value="" {% if ticket.status == "" %}selected{% endif %}>---------</option>
              <option value="Created" {% if ticket.status == "Created" %}selected{% endif %}>Created</option>
              <option value="In Progress" {% if ticket.status == "In Progress" %}selected{% endif %}>In Progress</option>
              <option value="Completed" {% if ticket.status == "Completed" %}selected{% endif %}>Completed</option>
              <option value="Void" {% if ticket.status == "Void" %}selected{% endif %}>Void</option>
            </select>
        </div>
        <div class="form-group row">
            <label for="cat">Category</label>
            <input class="form-control" id="cat" name="category" value="{{ticket.category}}">
        </div>
        <div class="form-group row">
            <label for="urg">Urgency</label>
            <select name="urgency" class="custom-select" id="urg">
                <option value="" {% if ticket.urgency == "" %}selected{% endif %}>---------</option>
                <option value="Green" {% if ticket.urgency == "Green" %}selected{% endif %}>Low</option>
                <option value="Yellow" {% if ticket.urgency == "Yellow" %}selected{% endif %}>Medium</option>
                <option value="Red" {% if ticket.urgency == "Red" %}selected{% endif %}>High</option>
            </select>
        </div>
        <div class="form-group row">
            <label for="cb">Created By</label>
            <select name="createdBy" class="custom-select" id="cb" readonly>
              <option value="{{ticket.createdBy}}">{{ticket.createdBy}}</option>
            </select>
        </div>
        <div class="form-group row">
            <label for="at">Assigned To</label>
            <select name="assignedTo" class="custom-select" id="at">
              <option value="">---------</option>
              {% for user in users %}
                <option value="{{user}}" {% if ticket.assignedTo.username == user %}selected{% endif %}>{{user}}</option>
              {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary btn-block">Update Details</button>
    </form>
</div>

<div class="row centered" style="max-width: 500px">
    <button type="button" class="btn btn-danger btn-block" id="delete-btn">Delete Ticket</button>
</div>

<form action="/ticket/delete/{{ticket.ticketId}}" method="GET" id="delete-form"></form>

<script>
document.querySelector("#delete-btn").onclick = function() {
if (confirm("Are you sure you want to delete this ticket?"))$("#delete-form").submit();
};
</script>
{% endblock %}
